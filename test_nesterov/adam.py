import numpy as np

# Инициализация векторов user и target
np.random.seed(42)
#user = np.random.uniform(-3, 9, 1000)  # 10-мерный вектор user с элементами от -3 до 9
#target = np.random.uniform(-3, 9, 1000)  # 10-мерный вектор target с элементами от -3 до 9

user = np.array([0.0030787787,-0.5245667,-0.045520276,-1.0720066,-0.14234427,-0.12107483,-0.65200436,1.2156024,1.9165812,0.17458287,-0.35615045,-1.2060405,-0.16327055,-0.4530753,-0.7921171,-0.44633064,0.1810478,-0.56296474,-0.37837172,-0.32219595,-0.45015967,-0.3445811,-0.8491223,-0.65429235,-1.4540827,-0.82246375,-0.7379923,-1.0633283,-1.1151187,-0.87852114,-0.23055916,-0.49362108,-0.8628006,-0.43115836,-0.16249894,-0.4791359,-0.11590733,-0.81417495,-0.08701018,1.0637169,0.24630225,-0.033994198,-0.15063937,0.5005079,-0.55800354,0.08403847,0.77337855,-0.013028395,-0.16168265,-0.18328026,0.15341811,0.43663353,-1.0774049,-1.4406989,-0.6201145,-0.09847126,-0.3950738,-0.27959386,-0.6227332,0.1896689,-0.3313493,-0.5817746,-0.63393694,-0.13016242,0.08777755,-0.9030741,-0.25164765,-0.27212083,0.14157334,-0.11371372,-0.15285505,-0.47016722,-0.6128059,-0.21939103,-0.13109583,-1.2171274,-0.64836293,-0.38142186,0.5690739,-0.8674868,0.061251357,0.071946666,-0.4587955,-0.088359684,0.19875845,-0.51883435,0.09977917,-0.1301613,-0.6970961,-0.005604822,-0.3549562,0.3782492,-0.25971133,-0.32470152,-0.7104242,-0.41210833,-0.39028135,0.014752334,0.49624363,-0.023666482,1.0445251,-0.86172664,-0.36805087,-0.41353518,-0.27998567,-0.4332223,-0.23694512,-0.85469335,-1.5689499,-0.59778064,-1.3339148,-0.50425845,0.8987493,-0.23251076,-0.34679347,-0.81320775,-1.3494092,-0.16683504,0.04646854,-0.34272715,-1.3011951,-0.6492749,0.042633183,-0.25293127,0.053073607,-1.231018,-0.981815,-0.43940026,-0.81134415,0.088382356,-0.34003532,-0.43402338,0.22789752,1.05631,0.21249436,0.09586639,0.7004173,0.18231797,-0.26223913,0.229277,-0.6979797,-0.88184214,0.29903355,-0.54330987,0.20612526,0.27565336,-0.20089054,-0.105095096,-0.3545825,-0.94483536,0.28946918,0.24149312,-0.6052356,-0.51211286,-1.0453514,-0.5444388,0.09095305,0.34689918,-0.15006125,-0.90935975,-0.7881526,-0.5806827,-0.2503515,-0.64283025,-0.37907505,-0.8670847,-1.0496258,-0.8559542,-0.8787117,-0.5816628,-1.4556434,-0.28064683,0.0020175555,-0.26541305,-0.17346433,-1.1643558,-0.5190085,-0.9683847,-0.27783948,-1.6631323,-1.939994,-0.5813015,-0.58318007,-0.21278477,-0.69547427,-0.45056203,-0.5664389,-0.6049247,-0.15473038,-0.2663118,-0.73035055,-0.5939086,-1.5945616,-0.4754416,-1.0354345,-0.904936,-0.5854057,-0.87427366,-0.8448364,-0.9099525,-0.99747986,-0.29953805,-1.4067427,-1.3477378,-0.6365325,-0.7890364,0.124876216,-0.6396073,-0.65358114,-0.2723776,-0.36734414,-0.21303053,-0.48035738,-0.120854095,-0.32867125,0.1766519,-0.40614107,-0.37819102,0.14550307,0.01264742,-0.5240134,0.40501127,-0.7133958,-0.5513389,-0.32227746,-0.68261826,-1.1168803,-0.32134143,-0.41224185,-1.1077588,-0.9699573,-0.31075403,0.18305402,-1.1874332,-1.0403266,-0.35334498,-0.6337486,-0.16411135,-0.79256755,-0.3159645,-0.19739965,-0.5739236,-0.80283254,-1.0823635,-0.95178765,-0.7619247,-1.6094824,-0.27873763,-0.14927357,-0.4480645,0.084868535,-0.68721527,-0.7355032,-0.27371284,-0.97510195,-0.44762155,-0.4874931,-1.0522376,-0.275883,-0.7172626,-0.97728944,-1.4988132,-0.6304795,-0.5625686,-0.6460029,-0.21986993,0.33912742,-1.1477507,-0.6780522,-0.38169172,-1.2319847,-0.66118747,-0.37370178,-0.5118774,0.08368339,-0.28223264,-0.9270508,-0.495601,-0.35092604,-0.47009695,-0.17859378,0.25318542,0.18307626,-0.47711676,-0.075408265,0.7655217,-0.10630728,-0.6955816,-0.53375894,-0.99997157,-0.66089153,-0.6331473,0.014762983,-0.69653887,0.025365554,-1.076394,0.15379667,-0.52530843,0.8449682,0.43679318,-0.8852945,0.21285185,-0.31202742,-0.44894335,-0.15938784,-0.5171794,-0.6227796,-0.51765627,-0.07694485,-0.8082198,-0.9758664,-0.14519516,0.090029016,0.2847535,-0.23628806,0.3156211,-0.5104037,-0.19505288,0.98947555,0.06717728,0.4793765,0.7250469,0.9652948,-0.71144795,-0.16184779,-0.44359067,0.09946372,-0.09032705,-0.67054045,-1.0769118,0.11516537,0.32145727,0.052298576,-0.70663536,-0.23541664,-0.061297756,0.21374267,-0.3625066,0.19940673,0.089265905,0.81666344,-0.15293904,-0.5146103,-0.1504297,0.0019837897,-0.22315253,-0.2147795,-0.41356698,0.34637284,0.5857712,0.13391851,-0.38590053,-0.28387296,-0.87317866,0.46882796,0.30531493,1.569398,0.7864033,1.3825572,0.40153927,0.7899328,0.5990272,-0.031786203,-0.2926373,0.009445395,-0.27148822,-0.86037135,-0.27713645,-1.0663724,-0.66585535,0.062704764,0.29365313,-0.23701787,0.4529298,-0.34273723,-0.08253117,0.14262684,-0.092327006,-0.39712015,-0.18388188,0.022123992,0.33322206,0.34641182,-0.5052093,-0.39528877,-0.17604427,-0.625932,-0.18481274,-0.8500528,1.0494033,-1.2155156,-0.7361103,-0.5714414,-1.6983745,-0.23151153,-0.5230527,-0.66096896,-0.34970325,-0.7239356,2.129854,4.336284,0.68838626,-0.026795175,-0.18769087,-0.64251965,-0.27496797,-0.31024218,0.55199933,0.32899,-0.048209235,-1.9470067,2.2643504,-0.2477573,0.08881513,1.6912365,0.2669635,0.40539837,0.19115439,-0.24225377,0.93018496,0.21701938,-0.04068921,-0.49993965,0.29038,1.3132834,-0.14391243,-0.37608182,0.4305256,1.583399,0.19096205,0.81197727,-0.70732623,0.9959756,2.3213615,-0.14204872,-0.17752115,-0.64142114,-0.43578374,-1.180282,1.3742987,-0.34793818,-0.37367505,-0.45605558,1.9487503,-0.19726363,0.52014434,-0.09998253,0.10351361,-0.20144223,0.08121784,0.3229186,4.082111,1.028101,0.33770746,0.6639237,0.1713299,0.59429395,4.652415,-1.3815421,2.6366253,-0.08893235,0.97405237,0.5348498,1.0679779,1.5046495,4.4638553,-0.8699746,-0.0013519721,-0.12451175,0.22732903,0.42647868,0.821165,-1.3803936,-0.5058317,6.7247443,-1.0345657,-0.515618,0.4961577,-0.34398806,-0.22735263,-0.5441808,0.5330401,-0.16154897,-0.108083986,-0.5624188,-0.8943707,0.6464379,0.5175971,1.0088724,-1.0576197,1.4450611,-0.24400744,-0.8331396,-0.9053189,0.53007334,-0.3078082,-0.44167337,0.32047343,-0.06712328,1.7261658,0.44340637,1.0901854,0.91968954,0.60244536,-0.07551005,-0.6052168,0.57552975,-1.0875212,-1.3108605,-0.24728908,-0.81564265,-0.8914999,-0.68123686,0.5508923,0.5492783,1.2351037,-0.41234106,0.37104475,1.382129,-0.643347,-0.9213547,-1.4411232,1.2972411,1.4643282,1.8173493,-0.24728744,-1.4192827,-1.1923823,-1.7676271,1.1648773,-0.9625915,-0.44680107,-1.5079881,-0.20129035,-0.45955557,-0.7468419,-0.09082279,0.18553811,0.55783594,-0.23377874,-1.1094298,-0.053019043,0.62502056,-0.032743987,-0.4892045,-0.75206965,0.70347285,-0.5985422,-1.0641285,-0.4712251,-1.6131992,0.86199164,0.8440678,-1.6374315,-0.20514825,-0.26952046,0.100371584,1.1705287,0.5575285,-0.18731187,1.4514463,-0.7705272,0.74088645,-0.1551393,-1.2843481,-0.88378006,0.24684216,0.12408407,0.97078794,-1.0073614,0.417887,-0.586158,-0.68631256,-0.14793013,0.7963701,-0.41722357,-0.39093256,-0.53368455,0.585272,-0.13680014,0.03838023,0.057701513,0.64078695,-0.69068295,1.5087645,0.1189935,-0.05754403,0.68847704,0.34633586,-0.36050445,1.0676919,0.8354575,-1.3864789,-0.26255143,0.42929304,-0.49484926,0.01715686,0.7930074,-0.91459817,-0.23706535,0.9132214,0.76822346,0.2706475,-0.21373451,-0.0038408195,0.06502689,0.04488071,-0.05469343,4.3478413,-0.61561716,8.463717,-0.5364772,-0.17226276,0.35292032,2.2314048,1.7226076,1.5322007,3.8182888,-0.74052835,-0.14843541,0.19000567,-0.038090065,0.19686297,0.23962826,-0.060624026,-0.0034641922,0.39375708,0.3800579,-0.49606273,0.12844566,1.8722311,0.6133657,-0.19135289,-0.5096986,-0.055339426,-0.18736324,2.5723248,-0.9110889,5.592922,2.845949,-0.4588949,2.10734,0.37413508,1.3880857,-0.33023685,-0.005045412,1.0099326,-1.1557906,-0.9510472,0.40309584,0.36948517,-0.67564106,2.4944582,0.89454585,-0.54024905,1.781923,-0.95184445,-0.21586241,0.1936979,0.26537347,-0.6275231,-1.0350864,-0.34923297,-0.35625726,-0.8401387,-0.24413301,0.37851617,3.057958,0.07223481,-2.2681925,-0.4218623,-0.5997428,-0.27777466,-0.7075472,-0.7391996,-0.7880815,0.7508739,0.24741542,1.6743934,1.190861,0.96803385,0.72583145,-0.06167574,2.1173346,1.0973214,-1.3577762,-1.499517,0.23486488,0.08112071,0.8708749,-0.48237595,0.26104626,0.71338725,0.64374167,-0.62506515,0.36790457,1.5954713,2.5242624,-0.26296806,1.1412979,-0.5603708,0.18945602,0.06430577,0.13887103,-0.39306238,-0.057979137,0.22803093,-0.36734772,0.06597453,1.3254529,0.4568567,-0.12704663,-0.9175158,-1.1022956,1.049873,1.5309509,0.5004975,-1.1520424,0.10631989,-0.48449996,-0.6905914,2.0189855,1.2404677,0.89892375,0.3978767,0.043254174,0.2565476,0.45734328,0.08515465,-0.08224194,-0.18302244,1.1749585,-0.13040453,0.97931796,-0.33450007,1.7250042,-0.56408477,-0.5060427,1.5627341,-1.0423625,-0.23877712,-0.05634361,-1.3445944,0.748576,-0.4939264,-0.29206797,0.45133638,0.029483939,0.25665292,-0.18860221,0.44246355,-0.1894343,0.028761648,-0.43194857,-0.25744802,-0.84511226,-0.28344515,-1.5508878,0.57264054,0.5188868,0.2651603,0.011201236,0.39526287,0.10246898,-0.021211794,0.24530563,-0.39770097,0.9005181,1.5643142,0.51034325,-0.054276533,-1.2482826,0.88625824,-0.0879015,-0.5045127,0.94160885,0.22743687,0.49407414,-0.8739401,-0.33753374,-0.55455196,0.30066267,-0.5585272,-0.45118994,-0.1908885,0.802828,-0.5443306,0.503852,-0.57475173,-0.54735845,0.7477981,-0.40544546,0.76192045,0.93894994,-0.2801363,-0.47606653,0.9846299,-0.30470908,0.29928315,-0.70948595,-0.007720977,0.33099508,-0.42679846,-0.6712702,-0.26661524,1.6316044,1.0811433,-0.9291901,0.8157526,-0.17845325,-0.67133665,-1.0053822,-0.5598846,0.64408994,-0.1760237,-0.4819455,-0.6326485,-0.639646,1.2117822,0.61935675,-0.8358726,-0.75595856,0.59032655,1.5595847,2.079258,0.029742297,-0.25265843,-0.8963666,-1.184382,-0.3481971,0.36903125,0.39776817,-0.8703005,-0.7107375,5.7880363,0.25166187,1.3007221,1.1970781,1.1987743,-0.3283426,0.97487915,5.8318057,4.35099,-0.3201569,-0.32030347,0.63757044,0.45946348,0.6403749,0.092617825,-0.46365285,0.7972697,0.60967743,0.39263058,0.029428491,1.3611928,0.0063476227,-0.52879006,-0.19184126,-0.0935401,0.040080294,0.21650086,-1.4405253,1.7486913,-0.39919704,-0.95525897,0.86936146,-0.2497664,-1.041518,0.7594908,3.9104698,0.09230861,-0.43329385,0.031317122,0.18134362,-0.4507665,0.75627196,-0.3617425,-0.66663885,-0.6934997,0.5185046,0.78873414,-1.5128369,-0.6091528,0.8571336,0.69598246,3.638608,-0.61092377,3.4896019,-0.26652876,0.3414058,0.8963651,-0.7238357,0.34850714,-0.09380832,0.5943394,-0.17936955,-0.22413994,-0.5218422,0.28171635,0.021690607,-0.35210085,0.8463139,2.2958708,2.981655,-0.29948387,-0.031203587,7.2653027,0.12588862,-0.57453585,0.10298205,-0.32129872,5.6481023,0.29544777,-0.61255294,-1.3546444,-0.81789076,-0.212652,1.2112519,-0.4481021,0.34485736,-0.6063213,1.6575947,-1.0049411,0.73245394,-0.20718212,-0.6339409,-1.1354661,-1.225516,-0.48712796,1.2666987,-0.6430792,-0.3045391,1.2520126,-0.45870605,-0.057192493,-0.18864979,0.55184734,1.543457,0.5272831,-0.040376574,-0.19109982,-0.35015544,-0.1608838,0.043482557,-0.62478644,0.42104146,-0.30130032,-0.14583492,0.5839845,-0.27350092,-0.3925837,-0.36555672,0.86956203,-0.7280012,-0.5761882,-0.20238627,-0.19993402,-0.8183231,1.0011309,-0.91398776,-0.5435276,-0.57579565,-1.0385923,-0.07110144,-0.6609606,0.07421969,0.12755693,-0.10815815,-0.12055209,0.50799686,-0.52605236,0.46628714,0.6842059,-1.6252496,-0.72254926,0.80175126,0.1840518,0.21223205,0.200774,-0.12029909,-0.45661557,0.8559482,0.8340221,-0.7254615,-0.7460318,0.06828572,0.085081674,0.28049833,0.24582356,0.2762971,0.3298482,0.2853996,-0.21187183,-0.049538113,-0.4229053,0.402067,0.5435479,-0.727191,1.321414,0.29052392])
target = np.array([-0.030297974,-0.9843764,-0.5886416,-0.8948048,-0.16107374,-0.89691335,-0.7400663,0.75616705,0.78339607,-0.9073635,-0.49845552,-1.6255469,-1.1106625,-1.0865291,-1.1196407,-0.84529096,-0.5493176,-1.5232478,-0.5315006,-1.1495271,-0.5747108,-0.72305334,-2.01622,-1.0718366,-1.6151465,-0.9256398,-1.3639491,-1.2956823,-0.7158246,-1.0230862,-0.42439002,-0.99764025,-0.6138167,-0.33589587,-0.14300223,-0.5529776,-0.27240926,-0.95930594,-0.57875526,-0.034002855,-0.98603743,-0.5417182,-0.4432491,0.49326605,-0.7015189,-0.49955347,-0.61310905,-0.14930706,-0.92393476,-0.45024166,-0.19517997,0.29651833,-0.56730896,-1.024799,-0.7574577,-0.67207116,-1.3004571,-0.9189973,-1.0190613,-0.061204262,0.122582376,-0.46665716,-0.45610905,-0.2761708,-0.55165094,-0.73899454,-0.09785106,0.22307427,0.16909702,0.3656575,-1.0213622,0.09904014,-1.3962016,-0.3705722,-0.8259015,-1.5958949,-1.0893714,-0.5654219,-0.69043654,-0.29733405,-0.08478758,-0.42867503,-1.5480219,-0.72065234,-0.5910137,-1.4730109,-0.7197478,-0.093073145,-1.8006228,-0.94782245,-1.4914762,-1.0402622,-1.1486851,-0.75680274,-1.798733,-1.0776134,-1.2642528,-0.748231,-0.83753407,-0.5042195,-0.7327285,-0.70162493,-1.0381681,-0.38154662,-0.31647512,-1.0335298,-0.4510072,-0.47566074,-1.0264181,-0.75509804,-0.4755022,-0.6083738,0.15470958,-0.23682775,-0.33230284,-0.47520858,-1.3640591,0.7414354,-0.34388822,-1.0856347,-1.326378,-1.0367132,-0.14535335,-0.31323487,-0.75008655,-1.5855998,-0.8749135,-1.5405519,-1.4350933,-1.046513,-1.4948676,-1.5562562,-1.1839094,-0.2135902,-1.5276331,-1.1568084,-0.25336105,-0.43738693,-0.5810865,-0.79278296,-1.0073304,-1.2576602,-0.49757507,-0.8442014,-1.4025441,-0.58360606,-1.5996014,-0.9181219,-0.7584106,-0.73108304,-0.39178017,0.38282415,-0.43278793,-0.69472367,-1.4570333,-0.7148441,-0.13093655,-0.115096405,-0.36675406,-1.0104132,-0.35361332,-0.35340187,-0.4504705,-0.05980727,-0.21608873,-0.05892098,-0.57339615,-0.3769493,-0.061781824,0.18913248,-0.98924464,0.12585524,0.055681687,-0.14494169,0.16591953,-1.2318952,-0.25133115,-0.082607925,-0.43893355,-1.0963844,-1.5566053,-0.5149942,-0.7018555,-0.11080391,-0.8783853,-0.98817194,-0.95315045,-0.36715093,-0.6330657,-0.47262895,-0.20278795,-0.5882493,-1.2912748,-0.43662524,-0.8350732,-0.38758323,-0.3364702,-0.8234014,-0.9856283,-0.28732428,-1.4730911,-0.1900832,-1.6010416,-1.0684452,-0.6351866,-1.1448631,-0.3390309,-0.46068627,-0.4279293,-0.86782604,-0.6901348,-0.4214382,-0.47830683,-0.5711813,-0.40503377,-0.1736789,-0.5700195,-0.25523075,0.25557145,-0.9080181,-0.63818103,-0.57122254,-0.8261416,-1.0085541,-0.28196234,-0.6414877,-0.83758426,-0.5753485,-1.0356494,-0.78954643,-0.82452714,-0.20728257,0.49902284,-1.0698656,-1.1358851,-0.27601486,-0.35899088,-0.19686735,-0.95873487,-0.8255767,-0.3742363,-0.78770125,-0.96148294,-1.3316027,-0.93292916,-1.2422428,-0.6473298,-0.14398423,-0.21164608,-0.09114247,0.12146072,-0.4059813,-0.7580008,0.42240754,-0.96395826,-0.5876246,-0.39516586,-0.2872467,-1.0814924,-1.011249,-0.83490884,-1.4546399,-1.1095414,-0.98921794,0.24007761,-0.47334403,-0.6006847,-1.3761607,-0.44235763,-1.3691183,-2.05585,-1.2672427,-1.1591929,-1.1565332,-1.0298996,-1.1365284,-1.3049431,-1.853077,-1.2207065,-2.259934,-0.9260145,-0.20696868,-0.5205635,-1.1416961,-0.55434406,-0.35219875,-0.9632027,-1.8257507,-1.6646404,-2.209357,-1.8471014,-1.4752576,-1.1594472,-1.8006257,-1.5966973,-1.439682,-1.4189223,-1.2925344,-0.97205573,-1.0445201,-0.7152009,-0.53369087,-1.0545989,-0.50301063,-1.2797524,-0.9995629,-0.9960323,-0.5739616,-1.0284114,-1.0479642,-0.44551837,-1.0982834,-0.8915755,0.40393922,-0.96808386,-0.83579737,-0.73708934,-0.7835055,-0.8929179,-0.41464767,-0.5307661,-0.61794364,-0.05987134,-0.9565716,-1.4118073,-1.4794708,0.47250375,-0.8540964,-0.8942154,-1.494145,0.06816532,0.06795758,-0.403176,-0.9148282,-1.142531,-0.50449586,-0.66419464,-0.6958056,-0.49662656,-0.23673947,-0.65049046,0.050799534,-0.55054426,-0.76015997,-0.6381024,0.27865934,-0.41591242,-0.6980072,-0.8919417,-0.6825374,-0.05258416,-0.24253002,-0.74781954,-0.54771036,-0.25286344,-0.10837074,0.14645542,-0.7637261,0.2606317,-0.5127925,-0.60665315,-0.30254954,-0.13802144,-0.2565677,-0.27348197,-0.71783715,-0.90414935,-0.10404782,-1.8909031,-1.0591608,-0.7784885,-0.7751743,-1.5128375,-1.1235819,-1.8012034,-1.3401229,-0.7053794,-1.1080893,-1.5582436,-0.92794204,-0.89497554,-1.1859133,-1.2032696,-1.0131644,-0.72702783,-0.58261174,-1.2302276,-1.6401814,-1.4797808,0.7958802,-0.810979,0.10177835,-0.69182825,-1.1950574,-0.18992496,-0.14911981,0.1657201,-0.80940187,0.2150488,1.7139455,3.3074937,0.88539904,0.7819649,0.15858497,-0.8910175,-0.20289987,0.34999102,0.17290327,0.47564486,0.18070532,-1.2284803,1.5798897,-0.012848567,0.28108075,1.6882266,-0.361207,1.0253854,0.086987466,-0.82747054,2.0279858,1.9120288,1.3496966,0.81297654,1.2730079,0.7822079,-0.33786073,-0.92277086,0.5346197,1.7104515,-0.34360915,0.13658361,0.7845256,1.7790859,1.4015832,0.5459541,0.25342175,-0.77397156,-0.89414084,-0.27965656,2.3026693,0.16567928,-0.34626278,-0.48763624,1.0471673,-0.17401272,0.06470058,1.744386,0.5252097,-0.5097002,-0.008735297,0.49939746,4.593888,2.6488216,0.92888474,0.36687735,0.5315126,0.4908445,3.7701032,-0.61564225,1.5261714,-0.044732846,0.9042351,0.7307883,1.7067742,3.1274693,4.991627,-0.11359118,0.030424003,-0.4950035,0.44451407,1.7108186,1.3719864,-0.9363002,0.06261897,8.563624,-0.06117092,0.2705734,1.3614084,-0.066353105,0.25353554,0.070078194,0.8324871,0.44431776,-0.3200893,-0.89463365,-0.029569894,0.5670462,0.432986,0.59486336,0.22281237,1.3714712,0.6240641,-0.2992742,-0.21857974,0.0010883249,-0.62003416,-0.3109859,-0.19455281,-0.31844297,2.4336782,-0.12575124,2.7493625,2.3480992,0.5576064,-0.7444186,-1.5702963,0.7733123,-0.27949578,-0.12570068,-0.8710945,-1.0197124,-0.56230825,-0.23297092,1.3629693,2.918957,2.4322462,1.0586904,-0.044057317,2.0541933,0.069385186,-0.2420372,-0.14954665,0.48012352,2.3782089,1.0621858,0.027884489,0.0749724,-0.26487002,-1.9432874,1.343487,-0.34989554,-0.101831615,-0.65869784,0.54828626,0.35585937,0.47628847,0.2016479,-0.10005355,-0.54803336,1.1514425,-1.2101035,1.167271,1.6582369,0.52905715,-0.30688766,0.61461484,0.87679386,-0.72817266,-0.7993983,-0.0027172621,-1.4473579,1.0241345,0.2719198,-0.4903003,-0.8011917,-0.12425166,1.198731,0.66588575,1.2076652,0.99567634,0.52600724,-0.9995671,0.59783846,-0.83744067,-0.19901338,-0.85941607,0.70495194,0.50880647,1.8250299,-0.9394124,1.5321478,-1.0681988,-0.44074798,0.2904381,-0.7534541,-1.249226,-0.5853891,0.6519453,0.0776833,-0.22067273,0.042705204,-0.5280364,0.24899472,0.24744222,0.6597797,1.0648365,-0.19538781,1.345977,0.550262,1.0002495,1.2977803,1.3938506,-0.90054977,0.8941117,0.6177703,-0.6281228,0.88646245,2.140568,-0.7717136,-0.2607742,1.1240194,0.9948243,1.225026,-0.41035697,0.5038399,0.5905912,1.4872007,-0.47801712,8.566105,-0.5602737,6.24494,0.4211095,0.91951793,1.2166435,1.4636835,2.6887872,0.81681395,4.191723,-0.42508194,0.18496308,0.7495371,-0.4335128,0.031497493,-0.5184739,0.10584416,-0.4469761,1.3615475,0.566309,-0.645782,0.015073451,4.290861,1.1828856,0.7267977,0.42039233,0.62401587,-0.2837815,2.3533971,-0.11234113,2.6089153,0.49782366,0.4815983,2.7823403,0.802691,1.8012445,0.46126515,0.016800346,1.6550722,-0.5147384,-0.66811794,0.20143613,1.1896234,0.105328605,2.6396434,0.88097984,0.019723693,2.3753295,-0.9759628,-0.05156866,0.5504465,-0.2165636,-0.08187041,-1.0622941,0.22617836,-0.5658274,-0.4463922,0.11810132,0.99949574,2.2348807,-1.0051665,-1.0874976,-0.09843181,-0.3000627,0.2819995,-0.10142411,0.568245,0.18265186,0.63289875,0.31467512,2.6775694,-0.10483588,1.8818245,1.2432649,0.17971206,3.4392352,0.72966653,-1.4759109,-0.7187913,-0.00020911731,0.258886,2.2915368,0.40184772,1.2585139,0.37819773,-0.12478922,-0.8356525,0.827617,1.6059898,1.9998562,-0.2538523,1.966055,0.0045032613,-0.062338263,1.6722707,0.44202513,-0.26731047,-0.14226253,0.50427806,-0.6148353,1.3510303,2.002911,0.5836313,-0.39912593,-0.016402233,0.028067138,1.1662258,1.7608951,-0.088955596,-1.283026,0.19243823,-0.20783448,0.038594533,0.5038224,1.0551046,0.30203286,-0.4028997,-1.0967344,1.1649897,-0.17825884,1.3066567,0.6940031,-0.7231627,2.2346885,0.12850565,1.0958366,-0.20106094,1.7806691,-0.4449664,-0.598391,1.3331269,0.64879286,1.2579838,1.1157718,0.15585266,1.2214547,-0.55831605,0.5868875,-0.26231098,1.0542326,0.41000742,0.49443015,0.77280396,-0.24472772,0.27794927,0.5361337,-0.6289211,-0.4617991,-0.8522203,-1.1776733,0.060780164,0.7076444,0.14984143,1.1398045,0.4099291,1.527201,0.7636341,1.4239194,-0.12825401,0.22504665,1.1059102,0.94303244,0.47881082,0.41766503,1.3158365,-0.6960277,0.49758917,0.7109331,1.4133825,0.8807947,-0.26132482,-0.6080976,-1.3063602,-0.7141318,0.5791463,0.53714293,0.6789475,1.5540562,0.4560476,0.76662517,-0.42864496,0.18548712,1.4998084,0.02945362,1.5076258,1.924432,-0.6289673,-0.059549022,2.5796423,1.510499,0.74096406,0.050974153,0.2030405,0.5141455,-0.508183,-0.8990155,-0.21896105,0.73882484,1.4669288,-0.38403434,2.0664485,-0.5351337,-0.13221574,0.86270404,0.165992,1.1279211,-0.9213506,-0.4942452,0.094244204,-0.63942605,1.8036388,0.81137,-0.2921189,-0.73946726,0.6280257,0.9463711,2.9622078,-0.14333051,-0.28094426,0.2462597,-0.22168863,-0.053731438,2.071027,0.21575776,-0.8141618,-0.7237874,7.4288616,0.42002317,2.6372192,2.0202758,0.9313851,0.25712994,0.5952857,7.520332,3.840042,0.6844545,0.31093365,0.590285,1.0612909,0.73770255,0.86782354,-0.83576274,-0.22931051,1.3161782,-0.27997175,0.76978457,1.1274805,0.43810213,-0.23408957,0.27239498,-0.8692079,0.2634184,0.3716865,-0.22388771,2.7607548,-0.42837846,-0.73119944,0.32940158,-0.23661605,-0.43251073,0.5579259,6.5194416,0.50317055,-1.2920969,0.3135252,0.22287634,-0.6918881,1.43793,0.19386819,0.1621931,-0.1665219,1.8174996,1.4998538,-0.16784249,0.39889225,0.6509748,0.7393228,3.7547839,-0.6786475,2.460009,0.42863792,0.8818964,-0.24004737,0.06338874,-0.3107778,1.198453,1.7164047,-0.4550922,0.116245985,0.3675766,0.715684,0.34043354,-0.4397787,0.24895678,2.1993628,1.8236722,0.055492464,0.42972502,7.456256,0.07889369,0.23852645,-0.0072338628,0.7277194,6.255834,0.5788428,-0.57439566,-1.8504556,-0.94997597,-0.25473705,1.5719653,-0.29480025,-0.28053573,-0.046413053,1.6367909,-0.7618495,-0.15680498,-0.9187425,-0.68378556,-0.9354947,-0.95623463,-0.6401497,1.4958559,0.024929158,-0.04755429,0.861788,-0.36844105,0.38298193,0.1333357,0.32472804,0.8874186,0.06427523,-0.7084116,-0.4183003,-0.68101937,-0.57150626,-0.66908556,-0.8387838,-0.351306,-0.52436215,-0.035957724,-0.30928764,-1.0495074,-0.59413135,-0.34021902,0.3185554,-0.28107384,-0.3414279,-0.48754248,-0.6878305,-0.5788505,0.6891847,-1.046347,-1.0510368,-0.2947073,-0.45719913,-0.05104843,-0.45187685,-0.5439672,-0.10312035,-0.9365737,-0.44955122,0.107403,0.26988086,0.02242562,0.010284051,-0.47247937,-0.8735871,1.1349552,-0.27165452,1.0219283,-0.4313095,0.3949488,-0.15266709,0.43355516,1.3101805,-0.41898385,-0.1810867,0.24865639,0.010180464,0.43618464,-0.37797308,-0.35749173,0.05592441,-0.22480093,-0.4882477,0.16457048,-0.7974216,0.041181512,0.6382835,-0.67177355,1.2238232,0.5931775])  # Целевой вектор


# Параметры Adam
learning_rate = 0.1
beta1 = 0.9
beta2 = 0.999
epsilon = 1e-8

# Моменты первого и второго порядка
m = np.zeros_like(user)
v = np.zeros_like(user)

# Счётчик шагов
t = 0

# Функция для вычисления градиента
def compute_gradient(target, user):
    return user - target

# Адам-оптимизация
for epoch in range(1000):
    t += 1

    # Вычисляем градиент
    grad = compute_gradient(target, user)

    # Обновляем моменты
    m = beta1 * m + (1 - beta1) * grad
    v = beta2 * v + (1 - beta2) * (grad ** 2)

    # Коррекция смещения
    m_hat = m / (1 - beta1 ** t)
    v_hat = v / (1 - beta2 ** t)

    # Обновляем вектор user
    user -= learning_rate * m_hat / (np.sqrt(v_hat) + epsilon)

    # Расстояние до цели
    distance = np.linalg.norm(user - target)

    # Выводим прогресс каждые 10 эпох
    if epoch % 10 == 0:
        print(f"Эпоха {epoch}: расстояние до цели = {distance:.6f}")

    # Останавливаем, если достаточно близко к цели
    if distance < 1e-6:
        print(f"Цель достигнута на {epoch}-й эпохе.")
        break

# Финальный результат
print("\nФинальный вектор user:", user)
print("Целевой вектор target:", target)
